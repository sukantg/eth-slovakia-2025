const jwtService = require('../services/jwtService'); module.exports = (req, res, next) => { const token = req.headers.authorization?.split(' ')[1]; if (!token) return res.status(401).json({ error: 'Missing token' }); try { req.user = jwtService.verifyToken(token); next(); } catch { res.status(403).json({ error: 'Invalid token' }); } };